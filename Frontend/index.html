<!DOCTYPE html> 
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MedWaste AI</title>
    <link rel="stylesheet" href="style.css">
</head>  
<body>
    <img class="image-gradient" src="gradient.png" alt="gradient">
    <div class="layer-blur"></div>

    <div class="container">
        <header>
            <h1 class="logo">MED WASTE</h1>
            <nav>
                <a href="#">DESCRIPTION</a>
                <a href="#">ABOUT</a>
                <a href="#">TESTIMONIAL</a>
                <a href="#">FUTURE ROADMAP</a>
            </nav>
            <button class="btn-signing">LOG IN</button>
        </header>

        <main>
            <div class="content">
                <div class="tag-box">
                    <div class="tag">AI-DRIVEN BIOMEDICAL WASTE MANAGEMENT &wedbar;</div>
                </div>

                <h1>MULTI-AGENT AI FOR<br> WASTE CLASSIFICATION & LEGAL COMPLIANCE</h1>
                <p class="description">
                    MedWaste AI is a multi-agent AI system designed for automated biomedical waste classification
                    and legal compliance.
                </p>

                <div class="buttons"> 
                    <button onclick="startRecording()" class="btn-get-started">Speech</button>
                    <input type="text" id="text-input" placeholder="Enter legal query">
                    <button onclick="sendTextRequest()" class="btn-get-started">Text</button>
                    <input type="file" id="image-upload" accept="image/*">
                    <button onclick="sendImageRequest()" class="btn-get-started">Image</button>
                </div>
                <h3>Response:</h3>
                <p id="response-text"></p>
            </div>
        </main>  

        <!-- 3D Robot -->
        <spline-viewer class="robot-3d" url="https://prod.spline.design/i4imzoUBeMfjljPj/scene.splinecode"></spline-viewer>
    </div>

    <!-- Import Spline 3D Viewer -->
    <script type="module" src="https://unpkg.com/@splinetool/viewer@1.9.79/build/spline-viewer.js"></script>
    <script>
        const socket = new WebSocket("ws://localhost:8000/ws/speech");
        socket.onmessage = (event) => {
            document.getElementById("response-text").innerText = event.data;
        };
        async function startRecording() {
            const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
            const mediaRecorder = new MediaRecorder(stream);
            mediaRecorder.ondataavailable = (event) => {
                if (event.data.size > 0) {
                    socket.send(event.data);
                }
            };
            mediaRecorder.start(500);
        }
        async function sendTextRequest() {
            const textInput = document.getElementById("text-input").value;
            const formData = new FormData();
            formData.append("query", textInput);
            const response = await fetch("http://localhost:8000/process-text", {
                method: "POST",
                body: formData
            });
            const data = await response.json();
            document.getElementById("response-text").innerText = data.message;
        }
        async function sendImageRequest() {
            const imageInput = document.getElementById("image-upload").files[0];
            const formData = new FormData();
            formData.append("file", imageInput);
            const response = await fetch("http://localhost:8000/process-image", {
                method: "POST",
                body: formData
            });
            const data = await response.json();
            document.getElementById("response-text").innerText = JSON.stringify(data.detections, null, 2);
        }
    </script>
</body>  
</html>